version: '3.2'
services:
  alfresco:
    image: ${DOCKER_IMAGE}
    ports:
      - target: 8080
        published: 80
        mode: host
      - target: 8000
        published: 8000
        mode: host
    environment:
      - INDEX=solr6
      - SOLR_HOST=solr
      - SHARE_HOST=share
      - ENABLE_CLUSTERING=true
      - CATALINA_OPTS=-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=8000
    depends_on:
        - postgresql

  share:
    image: hub.xenit.eu/alfresco-enterprise/alfresco-share-enterprise:5.2
    ports:
      - target: 8080
        published: 8082
        mode: host
    environment:
      - ALFRESCO_HOST=alfresco
    depends_on:
      - alfresco

  solr:
    image: hub.xenit.eu/alfresco-enterprise/alfresco-solr6:1.2.0
    restart: unless-stopped
    environment:
      - ALFRESCO_HOST=alfresco-core

  postgresql:
    image: docker.io/xenit/postgres
    environment:
      - POSTGRES_USER=alfresco
      - POSTGRES_PASSWORD=admin
      - POSTGRES_DB=alfresco

